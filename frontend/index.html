<!doctype html>
<html lang="hr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Landsky Wedding — Upit</title>
  <style>
    :root{
      --bg1:#0b0f14;
      --bg2:#1a2430;
      --card:rgba(18,24,32,.74);
      --border:rgba(255,255,255,.10);
      --muted:rgba(255,255,255,.65);
      --text:#fff;
      --accent:#e0b85a;
      --ok:#36d399;
      --err:#ff6b6b;
    }
    *{box-sizing:border-box;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;}
    body{
      margin:0;
      min-height:100vh;
      color:var(--text);
      background:
        radial-gradient(1200px 600px at 20% 10%, rgba(224,184,90,.18), transparent 55%),
        radial-gradient(800px 500px at 80% 30%, rgba(120,160,255,.15), transparent 60%),
        linear-gradient(160deg, var(--bg2), var(--bg1));
      display:flex;
      align-items:center;
      justify-content:center;
      padding:28px 14px;
    }
    .wrap{width:min(980px,100%);}

    .top{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:16px;
      margin-bottom:18px;
    }
    .brand{
      display:flex;
      align-items:center;
      gap:16px;
    }
    .logoBadge{
      width:78px;height:78px;
      background:#fff;
      border-radius:18px;
      display:flex;
      align-items:center;
      justify-content:center;
      border:1px solid rgba(0,0,0,.08);
      box-shadow:0 10px 30px rgba(0,0,0,.35);
      overflow:hidden;
    }
    .logoBadge img{
      width:62px;height:62px;object-fit:contain;
    }
    h1{margin:0;font-size:30px;letter-spacing:.2px;}
    .sub{margin-top:6px;color:var(--muted);font-size:14px;}
    .admin a{color:var(--accent);text-decoration:none}
    .admin a:hover{text-decoration:underline}

    .card{
      background:var(--card);
      border:1px solid var(--border);
      border-radius:18px;
      padding:18px;
      box-shadow:0 16px 60px rgba(0,0,0,.38);
      backdrop-filter: blur(10px);
    }
    .grid{
      display:grid;
      grid-template-columns:1fr 1fr;
      gap:14px;
    }
    .row{display:flex;flex-direction:column;gap:8px;}
    label{font-size:12px;color:var(--muted);letter-spacing:.2px;}
    input, textarea{
      width:100%;
      padding:12px 12px;
      border-radius:12px;
      border:1px solid rgba(255,255,255,.12);
      background:rgba(0,0,0,.24);
      color:#fff;
      outline:none;
    }
    input:focus, textarea:focus{
      border-color:rgba(224,184,90,.55);
      box-shadow:0 0 0 4px rgba(224,184,90,.18);
    }
    textarea{min-height:120px;resize:vertical;}
    .full{grid-column:1 / -1;}
    .actions{
      margin-top:14px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      flex-wrap:wrap;
    }
    button{
      padding:12px 18px;
      border-radius:12px;
      border:0;
      background:var(--accent);
      color:#111;
      font-weight:700;
      cursor:pointer;
      box-shadow:0 12px 24px rgba(224,184,90,.18);
    }
    button:hover{filter:brightness(1.02)}
    .hint{color:var(--muted);font-size:12px;}
    .msg{
      margin-top:14px;
      border-radius:14px;
      padding:14px;
      border:1px solid rgba(54,211,153,.35);
      background:rgba(54,211,153,.10);
      display:none;
      white-space:pre-wrap;
    }
    .msg.err{
      border-color:rgba(255,107,107,.35);
      background:rgba(255,107,107,.10);
    }
    @media (max-width:820px){
      .grid{grid-template-columns:1fr;}
      h1{font-size:26px;}
    }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="top">
      <div class="brand">
        <div class="logoBadge">
          <img src="logo.png" alt="Landsky Catering logo" />
        </div>
        <div>
          <h1>Upit za vjenčanje</h1>
          <div class="sub">Ispunite podatke, dodajte napomenu/pitanja i pošaljite upit.</div>
        </div>
      </div>
      <div class="admin"><a href="/admin">Admin</a></div>
    </div>

    <div class="card">
      <form id="f">
        <div class="grid">
          <div class="row">
            <label>Ime</label>
            <input name="first_name" placeholder="npr. Mario" required />
          </div>
          <div class="row">
            <label>Prezime</label>
            <input name="last_name" placeholder="npr. Kozina" required />
          </div>

          <div class="row">
            <label>Datum vjenčanja</label>
            <input name="wedding_date" type="date" required />
          </div>
          <div class="row">
            <label>Lokacija / Sala</label>
            <input name="venue" placeholder="npr. Sala Korana" required />
          </div>

          <div class="row">
            <label>Broj gostiju</label>
            <input name="guest_count" type="number" min="1" placeholder="npr. 120" required />
          </div>
          <div class="row">
            <label>E-mail</label>
            <input name="email" type="email" placeholder="npr. mladenci@email.com" required />
          </div>

          <div class="row full">
            <label>Telefon</label>
            <input name="phone" placeholder="npr. +385 99 123 4567" required />
          </div>

          <div class="row full">
            <label>Napomena / Pitanja (opcionalno)</label>
            <textarea name="message" placeholder="Npr. veganske opcije, bezalkoholni bar, okvirna cijena po osobi, posebne želje..."></textarea>
          </div>
        </div>

        <div class="actions">
          <button type="submit">Pošalji upit</button>
          <div class="hint">Nakon slanja prikazat ćemo potvrdu. U test fazi može se pojaviti i “preview link”.</div>
        </div>

        <div id="msg" class="msg"></div>
      </form>
    </div>
  </div>

  <script>
    const form = document.getElementById('f');
    const msgEl = document.getElementById('msg');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      msgEl.style.display = 'none';
      msgEl.classList.remove('err');

      const fd = new FormData(form);
      const payload = Object.fromEntries(fd.entries());
      payload.guest_count = Number(payload.guest_count);

      try{
        const r = await fetch('/register', {
          method: 'POST',
          headers: {'Content-Type':'application/json'},
          body: JSON.stringify(payload)
        });

        const data = await r.json().catch(()=> ({}));
        if(!r.ok){
          throw new Error(data.detail || 'Greška pri slanju upita.');
        }

        let text = (data.message || 'Upit poslan.');
        if (data.preview_url){
          text += "\n\nTEST preview:\n" + data.preview_url;
        }

        msgEl.textContent = text;
        msgEl.style.display = 'block';
        form.reset();

      }catch(err){
        msgEl.textContent = err.message || String(err);
        msgEl.classList.add('err');
        msgEl.style.display = 'block';
      }
    });
  </script>
</body>
</html>
